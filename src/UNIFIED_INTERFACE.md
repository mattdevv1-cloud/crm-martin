# โ ะะดะธะฝัะน ะธะฝัะตััะตะนั ะดะปั ะฒัะตั ัะพะปะตะน

## ๐ฏ ะะพะฝัะตะฟัะธั

ะะผะตััะพ ะพัะดะตะปัะฝัั ะธะฝัะตััะตะนัะพะฒ ะดะปั ัะฐะทะฝัั ัะพะปะตะน, ัะตะฟะตัั **ะพะดะธะฝ ะธะฝัะตััะตะนั** ั ััะปะพะฒะฝัะผ ะพัะพะฑัะฐะถะตะฝะธะตะผ ัะปะตะผะตะฝัะพะฒ ะฒ ะทะฐะฒะธัะธะผะพััะธ ะพั ะฟัะฐะฒ ะดะพัััะฟะฐ.

## ๐๏ธ ะััะธัะตะบัััะฐ

### ะกะธััะตะผะฐ ะฟัะฐะฒ ะดะพัััะฟะฐ (`/utils/roles.ts`)

**ะะพะฒัะน ัะฐะนะป:** ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝะพะต ัะฟัะฐะฒะปะตะฝะธะต ะฟัะฐะฒะฐะผะธ

```typescript
interface RolePermissions {
  // ะะฐะฒะธะณะฐัะธั
  canViewOrders: boolean;
  canViewCalendar: boolean;
  canViewProducts: boolean;
  // ... ะธ ั.ะด.
  
  // ะัะพะฑัะต ัะตะถะธะผั
  isCourierMode: boolean;
}
```

**5 ัะพะปะตะน ั ะดะตัะฐะปัะฝัะผะธ ะฟัะฐะฒะฐะผะธ:**
- `admin` - ะฟะพะปะฝัะน ะดะพัััะฟ
- `sales_manager` - ะทะฐะบะฐะทั, ะบะปะธะตะฝัั, ะพััััั
- `warehouse` - ัะบะปะฐะด, ัะพะฒะฐัั
- `accountant` - ะพััััั, ัะตะฝั, ะฐะฝะฐะปะธัะธะบะฐ
- `courier` - ัะพะปัะบะพ ะดะพััะฐะฒะบะธ (ัะฟะตัะธะฐะปัะฝัะน ัะตะถะธะผ)

## ๐ ะะปััะตะฒัะต ะธะทะผะตะฝะตะฝะธั

### 1. **App.tsx** - ะะดะธะฝะฐั ัะพัะบะฐ ะฒัะพะดะฐ

**ะัะปะพ:**
```typescript
if (user?.role === 'courier') {
  return <CourierView />;
}
// ... ะพัะดะตะป๏ฟฝ๏ฟฝะฝะฐั ะปะพะณะธะบะฐ ะดะปั ะบัััะตัะฐ
```

**ะกัะฐะปะพ:**
```typescript
// ะัะต ัะพะปะธ ะธัะฟะพะปัะทััั ะพะดะธะฝ renderContent()
return (
  <>
    <Layout currentPage={currentPage} onNavigate={handleNavigate}>
      {renderContent()}
    </Layout>
    <MobileNav currentPage={currentPage} onNavigate={handleNavigate} />
  </>
);
```

### 2. **Layout.tsx** - ะฃะผะฝะพะต ะผะตะฝั

**ะคะธะปัััะฐัะธั ะฟะพ ะฟัะฐะฒะฐะผ:**
```typescript
const allMenuItems = [
  { id: 'orders', label: '...', icon: ..., permission: 'canViewOrders' },
  { id: 'products', label: '...', icon: ..., permission: 'canViewProducts' },
  // ...
];

// ะะพะบะฐะทัะฒะฐะตะผ ัะพะปัะบะพ ะดะพัััะฟะฝัะต ะฟัะฝะบัั
const menuItems = allMenuItems.filter(item => permissions[item.permission]);
```

**ะะดะฐะฟัะธะฒะฝัะต ะฝะฐะทะฒะฐะฝะธั:**
- ะัััะตั ะฒะธะดะธั "ะะพะธ ะดะพััะฐะฒะบะธ" ะฒะผะตััะพ "ะะฐะบะฐะทั"
- ะะบะพะฝะบะฐ Truck ะฒะผะตััะพ Shopping Cart ะดะปั ะบัััะตัะฐ

### 3. **Orders.tsx** - ะะตะถะธะผ ะบัััะตัะฐ ะฒัััะพะตะฝ

**ะะฒะฐ ัะตะถะธะผะฐ ะฒ ะพะดะฝะพะผ ะบะพะผะฟะพะฝะตะฝัะต:**

```typescript
if (permissions.isCourierMode) {
  // ะัะพะฑัะฐะถะฐะตะผ ัะตะถะธะผ ะบัััะตัะฐ ั ะบะฐะปะตะฝะดะฐััะผ
  return <CourierCalendar ... />;
}

// ะกัะฐะฝะดะฐััะฝัะน ัะตะถะธะผ ั ัะฐะฑะปะธัะตะน
return <Table ... />;
```

**ะะพะผะฟะพะฝะตะฝัั:**
- `CourierCalendar` - ะบะฐะปะตะฝะดะฐัั ะดะพััะฐะฒะพะบ
- `CourierBottomSheet` - ะดะตัะฐะปะธ ะทะฐะบะฐะทะฐ ะดะปั ะบัััะตัะฐ
- ะัะต ะฒ Orders.tsx, ะฝะพ ะฟะพะบะฐะทัะฒะฐะตััั ััะปะพะฒะฝะพ

### 4. **MobileNav.tsx** - ะะดะฐะฟัะธะฒะฝะฐั ะฝะฐะฒะธะณะฐัะธั

**ะคะธะปัััะฐัะธั ะฟัะฝะบัะพะฒ:**
```typescript
const allNavItems = [
  { id: 'orders', label: permissions.isCourierMode ? 'ะะพััะฐะฒะบะธ' : 'ะะฐะบะฐะทั', ... },
  // ...
];

const navItems = allNavItems.filter(item => permissions[item.permission]);
```

**ะะตะทัะปััะฐั:**
- ะัััะตั: ัะพะปัะบะพ "ะะพััะฐะฒะบะธ" ะธ "ะะฐะปะตะฝะดะฐัั"
- ะะตะฝะตะดะถะตั: ะฟะพะปะฝะฐั ะฝะฐะฒะธะณะฐัะธั
- ะกะบะปะฐะด: ะะฐะบะฐะทั, ะกะบะปะฐะด
- ะ ั.ะด.

## ๐ ะะฐััะธัะฐ ะฟัะฐะฒ ะดะพัััะฟะฐ

| ะกััะฐะฝะธัะฐ | ะะดะผะธะฝ | ะะตะฝะตะดะถะตั | ะกะบะปะฐะด | ะััะณะฐะปัะตั | ะัััะตั |
|----------|-------|----------|-------|-----------|--------|
| ะะฐะบะฐะทั | โ | โ | โ | โ | โ (ัะตะถะธะผ ะดะพััะฐะฒะบะธ) |
| ะะฐะปะตะฝะดะฐัั | โ | โ | โ | โ | โ |
| ะกะบะปะฐะด | โ | โ (ะฟัะพัะผะพัั) | โ | โ (ะฟัะพัะผะพัั) | โ |
| ะะปะธะตะฝัั | โ | โ | โ | โ (ะฟัะพัะผะพัั) | โ |
| ะััััั | โ | โ | โ | โ | โ |
| ะะฐัััะพะนะบะธ | โ | โ | โ | โ | โ |
| ะััะฟะฟั | โ | โ | โ | โ | โ |
| Dashboard | โ | โ | โ | โ | โ |
| ะัะดะธั | โ | โ | โ | โ | โ |

## ๐จ ะะธะทัะฐะปัะฝัะต ัะฐะทะปะธัะธั

### ะะปั ะบัััะตัะฐ:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐ ะะฐะปะตะฝะดะฐัั    ๐ ะกะฟะธัะพะบ     โ  โ ะะตัะตะบะปััะฐัะตะปั
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  [ะะฝ] [ะั] [ะกั] [ะงั] [ะั]     โ  โ ะะตะดะตะปั
โ   5    6    7    8    9        โ
โ  3/5  1/3  0/2  โ   โ          โ  โ ะัะพะณัะตัั
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ะะฐะบะฐะทั ะฟะพ ะฒัะตะผะตะฝะฝัะผ ัะปะพัะฐะผ     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ะะปั ะผะตะฝะตะดะถะตัะฐ:
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  [+ ะกะพะทะดะฐัั ะทะฐะบะฐะท]             โ  โ ะะตะนััะฒะธั
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ะคะธะปัััั: ะกัะฐััั | ะะฐัะฟัะตะดะตะปะตะฝะธะตโ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ะขะฐะฑะปะธัะฐ ะทะฐะบะฐะทะพะฒ               โ
โ  | โ | ะะฐัะฐ | ะะปะธะตะฝั | ะกัะฐััั |โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ๐ ะะตะทะพะฟะฐัะฝะพััั

### ะัะพะฒะตัะบะฐ ะฝะฐ ััะพะฒะฝะต UI
```typescript
{permissions.canCreateOrder && (
  <Button onClick={onCreateOrder}>ะกะพะทะดะฐัั ะทะฐะบะฐะท</Button>
)}
```

### ะัะพะฒะตัะบะฐ ะฝะฐ ััะพะฒะฝะต ัะพััะธะฝะณะฐ
```typescript
if (!canAccessPage(user, currentPage)) {
  // ะะตะดะธัะตะบั ะฝะฐ ะดะพัััะฟะฝัั ัััะฐะฝะธัั
  const firstAvailable = availablePages.find(page => canAccessPage(user, page));
  setCurrentPage(firstAvailable);
}
```

### ะัะพะฒะตัะบะฐ ะฝะฐ ััะพะฒะฝะต ัะตัะฒะตัะฐ
```typescript
// ะ /supabase/functions/server/index.tsx
if (user.role === 'courier') {
  orders = orders.filter(order => {
    return order.courierId === user.id 
      && isDeliverable(order.status)
      && isToday OrTomorrow(order.deliveryDate);
  });
}
```

## ๐ฆ ะกัััะบัััะฐ ัะฐะนะปะพะฒ

### ะะพะฒัะต ัะฐะนะปั:
```
/utils/roles.ts                    - ะกะธััะตะผะฐ ะฟัะฐะฒ
/components/CourierBottomSheet.tsx - Bottom sheet ะดะปั ะบัััะตัะฐ
```

### ะะฑะฝะพะฒะปัะฝะฝัะต ัะฐะนะปั:
```
/App.tsx                - ะะดะธะฝะฐั ะปะพะณะธะบะฐ ะดะปั ะฒัะตั
/components/Layout.tsx  - ะคะธะปัััะฐัะธั ะผะตะฝั
/components/Orders.tsx  - ะะตะถะธะผ ะบัััะตัะฐ ะฒัััะพะตะฝ
/components/MobileNav.tsx - ะะดะฐะฟัะธะฒะฝะฐั ะฝะฐะฒะธะณะฐัะธั
```

### ะฃะดะฐะปัะฝะฝัะต ัะฐะนะปั:
```
/components/CourierView.tsx - โ ะะพะปััะต ะฝะต ะฝัะถะตะฝ
```

## ๐ฏ ะัะตะธะผััะตััะฒะฐ

### 1. **ะะดะธะฝะฐั ะบะพะดะพะฒะฐั ะฑะฐะทะฐ**
- ะะตะณัะต ะฟะพะดะดะตัะถะธะฒะฐัั
- ะะตะฝััะต ะดัะฑะปะธัะพะฒะฐะฝะธั
- ะัะพัะต ัะตััะธัะพะฒะฐัั

### 2. **ะะธะฑะบะพััั**
- ะะตะณะบะพ ะดะพะฑะฐะฒะธัั ะฝะพะฒัั ัะพะปั
- ะะตะณะบะพ ะธะทะผะตะฝะธัั ะฟัะฐะฒะฐ
- ะัั ะฒ ะพะดะฝะพะผ ะผะตััะต (`roles.ts`)

### 3. **ะะพะฝัะธััะตะฝัะฝะพััั**
- ะะดะธะฝะฐะบะพะฒัะน UX ะดะปั ะฑะฐะทะพะฒัั ััะฝะบัะธะน
- ะะดะธะฝะฐั ัะธััะตะผะฐ ะดะธะทะฐะนะฝะฐ
- ะะตะฝััะต ะฟััะฐะฝะธัั ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปะตะน

### 4. **ะะฐัััะฐะฑะธััะตะผะพััั**
- ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒะพะน ััะฝะบัะธะธ = ะฟัะพััะพ ะดะพะฑะฐะฒะธัั permission
- ะะพะฒะฐั ัะพะปั = ะพะฟะธัะฐัั permissions ะฒ ะพะดะฝะพะผ ะผะตััะต
- ะฃัะปะพะฒะธั ะฟัะพะฒะตัััััั ะฐะฒัะพะผะฐัะธัะตัะบะธ

## ๐ ะัะฟะพะปัะทะพะฒะฐะฝะธะต

### ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒะพะน ัะพะปะธ

1. **ะะฑะฝะพะฒะธัั ัะธะฟ ะฒ `roles.ts`:**
```typescript
export type Role = 'admin' | 'sales_manager' | 'warehouse' | 'accountant' | 'courier' | 'new_role';
```

2. **ะะฟะธัะฐัั ะฟัะฐะฒะฐ:**
```typescript
const permissions: Record<Role, RolePermissions> = {
  // ...
  new_role: {
    canViewOrders: true,
    canCreateOrder: false,
    // ... ะฒัะต permissions
  },
};
```

3. **ะะพัะพะฒะพ!** ะะฝัะตััะตะนั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฐะดะฐะฟัะธััะตััั

### ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒะพะณะพ permission

1. **ะะพะฑะฐะฒะธัั ะฒ ะธะฝัะตััะตะนั:**
```typescript
interface RolePermissions {
  // ...
  canExportData: boolean;
}
```

2. **ะฃััะฐะฝะพะฒะธัั ะดะปั ะฒัะตั ัะพะปะตะน:**
```typescript
admin: {
  // ...
  canExportData: true,
},
courier: {
  // ...
  canExportData: false,
},
```

3. **ะัะฟะพะปัะทะพะฒะฐัั ะฒ UI:**
```typescript
{permissions.canExportData && (
  <Button>ะญะบัะฟะพัั</Button>
)}
```

## ๐ฑ ะะพะฑะธะปัะฝะฐั ะฐะดะฐะฟัะฐัะธั

### ะะตัะบัะพะฟ:
- ะะพะบะพะฒะพะต ะผะตะฝั (Layout)
- ะะพะปะฝะฐั ัะฐะฑะปะธัะฐ
- ะัะต ัะธะปัััั

### ะะพะฑะธะปัะฝัะน:
- ะะธะถะฝัั ะฝะฐะฒะธะณะฐัะธั (MobileNav)
- ะะฐััะพัะบะธ ะฒะผะตััะพ ัะฐะฑะปะธั
- ะฃะฟัะพััะฝะฝัะต ัะธะปัััั

### ะัััะตั (ะฒัะตะณะดะฐ ะผะพะฑะธะปัะฝัะน):
- ะะฐะปะตะฝะดะฐัั ะดะพััะฐะฒะพะบ
- Bottom Sheet ะดะปั ะดะตัะฐะปะตะน
- ะัััััะต ะดะตะนััะฒะธั

## ๐งช ะขะตััะธัะพะฒะฐะฝะธะต

### ะัะพะฒะตัะบะฐ ะฟัะฐะฒ:
```typescript
import { getRolePermissions } from './utils/roles';

const courierPerms = getRolePermissions('courier');
expect(courierPerms.canViewProducts).toBe(false);
expect(courierPerms.isCourierMode).toBe(true);
```

### ะัะพะฒะตัะบะฐ ะดะพัััะฟะฐ:
```typescript
import { canAccessPage } from './utils/roles';

const courier = { id: 1, role: 'courier', ... };
expect(canAccessPage(courier, 'products')).toBe(false);
expect(canAccessPage(courier, 'orders')).toBe(true);
```

## ๐ ะกะฒัะทะฐะฝะฝัะต ะดะพะบัะผะตะฝัั

- [COURIER_GUIDE.md](COURIER_GUIDE.md) - ะัะบะพะฒะพะดััะฒะพ ะบัััะตัะฐ
- [MANAGER_COURIER_GUIDE.md](MANAGER_COURIER_GUIDE.md) - ะะฐะฑะพัะฐ ั ะบัััะตัะฐะผะธ
- [COURIER_CHECKLIST.md](COURIER_CHECKLIST.md) - ะงะตะบ-ะปะธัั ะฝะฐะทะฝะฐัะตะฝะธั
- [README.md](README.md) - ะะฑัะฐั ะดะพะบัะผะตะฝัะฐัะธั

## ๐ ะัะพะณ

โ **ะะดะธะฝ ะธะฝัะตััะตะนั** ะดะปั ะฒัะตั ัะพะปะตะน  
โ **ะฃัะปะพะฒะฝะพะต ะพัะพะฑัะฐะถะตะฝะธะต** ัะปะตะผะตะฝัะพะฒ  
โ **ะฆะตะฝััะฐะปะธะทะพะฒะฐะฝะฝัะต ะฟัะฐะฒะฐ** ะฒ `/utils/roles.ts`  
โ **ะะตะณะบะพ ัะฐััะธััะตััั** ะฝะพะฒัะผะธ ัะพะปัะผะธ ะธ ะฟัะฐะฒะฐะผะธ  
โ **ะะตะทะพะฟะฐัะฝะพ** - ะฟัะพะฒะตัะบะฐ ะฝะฐ ะฒัะตั ััะพะฒะฝัั  
โ **ะะดะฐะฟัะธะฒะฝะพ** - ัะฐะฑะพัะฐะตั ะฝะฐ desktop ะธ mobile  

---

**ะะตััะธั:** 3.0  
**ะะฐัะฐ:** ะะบััะฑัั 2025  
**ะะธะณัะฐัะธั:** CourierView โ Unified Interface
